<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">

        <title>FHF : QUIZ</title>

        <!-- Bootstrap -->
        <link href="assets/css/bootstrap.css" rel="stylesheet">
        <link href="assets/css/bootstrap-theme.css" rel="stylesheet">
        <link href="assets/css/jgrowl.css" rel="stylesheet">

        <!-- simple style -->
        <link href="assets/css/style.css" rel="stylesheet">
        <script src="assets/js/jquery2.1.3.min.js"></script>
        <script src="assets/js/jgrowl.min.js"></script>

        <!-- Latest compiled and minified CSS -->
        <!--<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.4/css/bootstrap.min.css">-->

        <!-- Optional theme -->
        <!--<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.4/css/bootstrap-theme.min.css">-->

        <!-- Latest compiled and minified JavaScript -->
        <!--<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.4/js/bootstrap.min.js"></script>-->
        <script src="question.js"></script>

        <script>
            //variables
            var viewedQuestions = [],
            totalAnswerTimeFirst = 30;  //in seconds
            totalAnswerPassTime = 10; //in seconds

            //check for localstorage
            if (localStorage.getItem('viewedQuestion') !== null) {
                viewedQuestions = JSON.parse(localStorage.getItem('viewedQuestion'));
            }

            $(function () {

                //Audio Elements
                var audioElementBackground = document.createElement('audio');
                audioElementBackground.setAttribute('src', 'backgroundmusic.mp3');

                var audioElementQuestion = document.createElement('audio');
                audioElementQuestion.setAttribute('src', 'question3.mp3');

                var audioElementWronganswer = document.createElement('audio');
                audioElementWronganswer.setAttribute('src', 'wrongAnswer.mp3');

                var audioElementTrueanswer = document.createElement('audio');
                audioElementTrueanswer.setAttribute('src', 'correct.mp3');
                
                var audioRapidFire = document.createElement('audio');
                audioRapidFire.setAttribute('src', 'rapidFire.mp3');


                //PLAY BACKGROUND AUDIO ON LOAD
                audioElementBackground.play();

                var timeoutId = "";



                $(document).keypress(function(e) {

                    var timeout = 3000;

                    if(e.which == 112) {
                        //pass
                        // Type p
                        passAnswer();
                        $.jGrowl("Pass!!!",{life : 3000});


                    } else if(e.which == 116){
                        //true
                        // Type t
                        audioElementTrueanswer.play();
                        window.clearTimeout(timeoutId);
                        setTimeout(closeQuestion, 200);
                        $.jGrowl("Right Answer!!!",{life : 3000});

                    } else if (e.which == 102){
                        //false
                        // Type f
                        audioElementWronganswer.play();
                        window.clearTimeout(timeoutId);
                        setTimeout(passAnswer, timeout);
                        $.jGrowl("Wrong Answer!!!",{life : 3000});

                    } else if (e.which == 99){
                        //close
                        // Type c
                        closeQuestion();

                    }  else if (e.which == 114){
                        console.log(e.keyCode);
                        //reset all questions
                        // Type r
                         clearLocalStorage();

                    } else if(e.which === 109) {
                        // Rapid Fire
                        stopMusic(audioElementBackground);
                        audioRapidFire.play();
                    } else if(e.which === 110) {
                        // Rapid Fire
                        stopMusic(audioRapidFire);
                        audioElementWronganswer.play();
                        audioElementBackground.play();

                    }
                    else if(e.which === 115) {
                        // Rapid Fire
                        stopMusic(audioRapidFire);
                        stopMusic(audioElementWronganswer);
                        audioElementBackground.play();

                    }
                });

                //countdown function
                function countdown(elementName, minutes, seconds)
                {
                    var element, endTime, hours, mins, msLeft, time;

                    function twoDigits(n)
                    {
                        return (n <= 9 ? "0" + n : n);
                    }

                    function updateTimer()
                    {
                        msLeft = endTime - (+new Date);
                        if (msLeft < 1000) {
                            stopMusic(audioElementQuestion);
                            audioElementWronganswer.play();
                            element.innerHTML = "<span style='color: #ee0000; font-size: 55px !important;'>Countdown's Over!</span>";
                        } else {
                            time = new Date(msLeft);
                            hours = time.getUTCHours();
                            mins = time.getUTCMinutes();
                            element.innerHTML = (hours ? hours + ':' + twoDigits(mins) : mins) + ':' + twoDigits(time.getUTCSeconds());
                            timeoutId = setTimeout(updateTimer, time.getUTCMilliseconds() + 500);
                        }
                    }

                    element = document.getElementById(elementName);
                    endTime = (+new Date) + 1000 * (60 * minutes + seconds) + 500;
                    updateTimer();
                }

                function stopMusic(ele) {
                    ele.pause();
                    ele.currentTime = 0;
                }

                var count = 1;
                $.each(question, function (i, v) {
                   // count = resetCount(count);
                   /* if(i <= 28){
                        var divContent = fetchQuestions(i, count);
                        $('.question-wrapper').append(divContent);
                    } else {
                        var divContent = fetchQuestions(i, count);
                        $('.question-wrapper-bonus').append(divContent);
                    }
                    count++;*/
                    $.each(v, function( ind , val){
                        var divContent = fetchQuestions(i + '-' + ind, ind);
                        $('.' +i+'-wrapper').append(divContent);
                    });


                });

                function fetchQuestions(i, count) {
                    if (localStorage.getItem('viewedQuestion') !== null) {

                        var qArray = JSON.parse(localStorage.getItem('viewedQuestion'));
                        if ($.inArray(i, qArray) !== -1) {
                            var divContainer = $('<span />', {'data-indx': i, 'class': 'strike'}).html(count);
                        } else {
                            var divContainer = $('<span />', {'data-indx': i}).html(count);
                        }
                    } else {
                        var divContainer = $('<span />', {'data-indx': i}).html(count);
                    }
                    return divContainer;
                }
                
                function resetCount(count){
                    if(count == 29){
                        var count = 1;
                    }
                    return count;
                }


                $('#pass').click(function () {
                    window.clearTimeout(timeoutId);
                    countdown("countdown", 0, totalAnswerPassTime);
                    stopMusic(audioElementQuestion);
                    audioElementQuestion.play();
                });


                $('.counterwrapper').on('click', 'span:not(".strike")', function () {
                    $(this).addClass('strike');
                    var indx = $(this).data('indx');
                    console.log(indx);
                    viewedQuestions.push(indx);
                    localStorage.setItem('viewedQuestion', JSON.stringify(viewedQuestions));

                    //$('#ques').html(question[indx]);
                    $questionArray = indx.split('-');
                    $('#ques').html(question[$questionArray[0]][$questionArray[1]]);
                   // $('#question_counter').html(indx);

                    $('.counterwrapper').fadeOut(function () {
                        window.clearTimeout(timeoutId);
                        countdown("countdown", 0, totalAnswerTimeFirst);
                        $('#quiz-answer').fadeIn(function () {
                            stopMusic(audioElementBackground);
                            audioElementQuestion.play();
                        });
                    });

                });

                $('#close').click(function () {
                    window.clearTimeout(timeoutId);
                    $('#quiz-answer').fadeOut(function () {
                        $('#countdown').html('');
                        stopMusic(audioElementQuestion);
                        audioElementBackground.play();
                        $('.counterwrapper').fadeIn();
                    });
                });

                $('#reset-localstorage').click(function () {
                    localStorage.removeItem('viewedQuestion');
                    window.location = window.location;
                });

                $('#pausebackgroundScore').click(function () {
                    audioElementBackground.pause();
                });

                $('#playbackgroundScore').click(function () {
                    audioElementBackground.play();
                });


               /* //stop the background sound
                $('#video1,#video2,#video3,#video4').on('show.bs.modal', function (e) {
                     audioElementBackground.pause();
                });
                $('#video1,#video2,#video3,#video4').on('hidden.bs.modal', function () {
                   audioElementBackground.play();
                })*/

                //pass 
                function passAnswer(){
                    
                    window.clearTimeout(timeoutId);
                    countdown("countdown", 0, totalAnswerPassTime);
                    stopMusic(audioElementQuestion);
                    audioElementQuestion.play();
                }
                //close 
                function closeQuestion(){
                    window.clearTimeout(timeoutId);
                    $('#quiz-answer').fadeOut(function () {
                        $('#countdown').html('');
                        stopMusic(audioElementQuestion);
                        audioElementBackground.play();
                        $('.counterwrapper').fadeIn();
                    });
                }
                //reset localStorage
                function clearLocalStorage(){
                    localStorage.removeItem('viewedQuestion');
                    window.location = window.location;                    
                }


                
             });
        </script>

    </head>

    <body>
        
        <div id="header">
            <div class="container">
                <img alt="PHP" src="assets/img/phpelephant.png">
            </div>
        </div>

        <div id="wrapper">
            <div class="container">
                <div class="row questions-block">
                    <div class="col-sm-12 col-md-12 col-lg-12 counterwrapper">
                        <h1>PHP</h1>
                        <div class="phpquestion-wrapper"></div>
                        <!--<div style="clear:both; display: none;">
                            <button id="reset-localstorage" style="clear:both;">Reset</button>
                            <button id="pausebackgroundScore">Pause Music</button>
                            <button id="playbackgroundScore">Play Music</button>   
                        </div>-->
                    </div>
                    <div class="col-sm-12 col-md-12 col-lg-12 counterwrapper">
                        <h1>PHP Sessions</h1>
                        <div class="devopsquestion-wrapper"></div>
                        <!--<div style="clear:both; display: none;">
                            <button id="reset-localstorage" style="clear:both;">Reset</button>
                            <button id="pausebackgroundScore">Pause Music</button>
                            <button id="playbackgroundScore">Play Music</button>
                        </div>-->
                    </div>
                    <div class="col-sm-12 col-md-12 col-lg-12 counterwrapper">
                        <h1>PHP Outing</h1>
                        <div class="phpoutingquestion-wrapper"></div>
                        <!--<div style="clear:both; display: none;">
                            <button id="reset-localstorage" style="clear:both;">Reset</button>
                            <button id="pausebackgroundScore">Pause Music</button>
                            <button id="playbackgroundScore">Play Music</button>
                        </div>-->
                    </div>
                    <div class="col-sm-12 col-md-12 col-lg-12 counterwrapper">
                        <h1>General Knowledge</h1>
                        <div class="generalknowledgequestion-wrapper"></div>
                        <!--<div style="clear:both; display: none;">
                            <button id="reset-localstorage" style="clear:both;">Reset</button>
                            <button id="pausebackgroundScore">Pause Music</button>
                            <button id="playbackgroundScore">Play Music</button>
                        </div>-->
                    </div>
                </div>

                <!--<div class="row">
                    <div class="col-sm-6 col-md-6 col-lg-6 counterwrapper wrapper-video">
                        <h1>Rapid fire</h1>
                        <div class="question-wrapper-video">
                            <ul class="list">
                                &lt;!&ndash;<li>
                                    <a href="javascript:;" data-toggle="modal" data-target="#video1">1</a>
                                </li>&ndash;&gt;
                                <li>
                                    <a href="javascript:;">1</a>
                                </li>
                                <li>
                                    <a href="javascript:;">2</a>
                                </li>
                                <li>
                                    <a href="javascript:;">3</a>
                                </li>
                                <li>
                                    <a href="javascript:;">4</a>
                                </li>
                                <li>
                                    <a href="javascript:;">5</a>
                                </li>
                            </ul>
                        </div>
                    </div>
                </div>-->
                
                <div class="row" id="display-question">
                    <div class="col-sm-12 col-md-12 col-lg-12" id="quiz-answer">
                        <!--<h1>FHF QUIZ: 2015</h1>-->
                        <!--<h2 class="subtitle">Q<span id="question_counter"></span>: <span id="ques"></span></h2>-->
                        <h2 class="subtitle"><span id="ques"></span></h2>
                        <div id="countdown"></div>
                        <!--<button id="pass">Pass</button>-->
                        <!-- <button class="stop">Pause Music</button>             
                        <button class="play">Play Music</button> -->    
                        <!--<button id="close">Close</button>--> 		
                    </div>
                </div>
            </div>
            
           <!-- <div class="modal fade" id="video1" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
                <div class="modal-dialog">
                    <div class="modal-content">
                        <div class="modal-header">
                            <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
                            <h4 class="modal-title" id="myModalLabel">Video One</h4>
                        </div>
                        <div class="modal-body">
                            <video width="320" height="240" controls>
                                <source src="videos/1.mp4" type="video/mp4">                               
                                Your browser does not support the video tag.
                            </video>

                        </div>

                    </div>
                </div>
            </div>
            <div class="modal fade" id="video2" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
                <div class="modal-dialog">
                    <div class="modal-content">
                        <div class="modal-header">
                            <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
                            <h4 class="modal-title" id="myModalLabel">Video Two</h4>
                        </div>
                        <div class="modal-body">
                             <video width="320" height="240" controls>
                                 <source src="videos/2.mp4" type="video/mp4">                                
                                Your browser does not support the video tag.
                            </video>                          
                        </div>
                        
                    </div>
                </div>
            </div>
            <div class="modal fade" id="video3" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
                <div class="modal-dialog">
                    <div class="modal-content">
                        <div class="modal-header">
                            <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
                            <h4 class="modal-title" id="myModalLabel">Video Three</h4>
                        </div>
                        <div class="modal-body">
                             <video width="320" height="240" controls>
                                 <source src="videos/3.mp4" type="video/mp4">                                
                                Your browser does not support the video tag.
                            </video>
                          
                        </div>
                        
                    </div>
                </div>
            </div>
            <div class="modal fade" id="video4" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
                <div class="modal-dialog">
                    <div class="modal-content">
                        <div class="modal-header">
                            <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
                            <h4 class="modal-title" id="myModalLabel">Video Four</h4>
                        </div>
                        <div class="modal-body">
                             <video width="320" height="240" controls>
                                 <source src="videos/4.mp4" type="video/mp4">                                
                                Your browser does not support the video tag.
                            </video>
                          
                        </div>
                        
                    </div>
                </div>
            </div>-->
        </div>      
    </body>
</html>
